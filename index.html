<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sales Dashboard - Data Management</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --bg: #ffffff;
      --card: #f8fafb;
      --text: #1a202c;
      --muted: #718096;
      --border: #e2e8f0;
      --accent-1: #bee3f8;
      --accent-2: #fbd38d;
      --accent-3: #c6f6d5;
      --accent-4: #fbb6ce;
      --accent-5: #e9d8fd;
      --glass: rgba(26, 32, 44, 0.05);
      --primary: #4299e1;
      --success: #48bb78;
      --danger: #f56565;
      --warning: #ed8936;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: Inter, system-ui, sans-serif;
      line-height: 1.6;
    }

    .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
    header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; flex-wrap: wrap; gap: 16px; }
    h1 { font-size: 24px; font-weight: 600; margin: 0; }
    .subtitle { font-size: 14px; color: var(--muted); }
    .controls { display: flex; gap: 12px; flex-wrap: wrap; }
    button, select { padding: 8px 16px; border-radius: 8px; border: 1px solid var(--border); background: white; cursor: pointer; font-size: 14px; transition: all 0.2s; }
    button:hover { transform: translateY(-1px); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .btn-primary { background: var(--primary); color: white; border: none; }
    .btn-success { background: var(--success); color: white; border: none; }
    .btn-danger { background: var(--danger); color: white; border: none; }
    .btn-sm { padding: 6px 12px; font-size: 12px; }

    .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 20px; }
    .card { background: var(--card); padding: 20px; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); transition: all 0.3s; }
    .card:hover { box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .kpi { grid-column: span 3; }
    .wide { grid-column: span 6; }
    .full { grid-column: span 12; }
    .kpi h3 { margin: 0 0 8px 0; font-size: 14px; font-weight: 500; color: var(--muted); }
    .kpi .value { font-size: 28px; font-weight: 600; margin-bottom: 4px; }
    .trend { font-size: 14px; display: flex; align-items: center; gap: 4px; }
    .positive { color: var(--success); }
    .negative { color: var(--danger); }
    .neutral { color: var(--muted); }

    .chart-container { position: relative; height: 300px; margin-top: 16px; }
    .tabs { display: flex; gap: 4px; margin-bottom: 16px; border-bottom: 1px solid var(--border); }
    .tab { padding: 10px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s; }
    .tab:hover { background: var(--glass); }
    .tab.active { border-bottom-color: var(--primary); color: var(--primary); font-weight: 500; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }

    .form-group { margin-bottom: 16px; }
    .form-group label { display: block; margin-bottom: 6px; font-weight: 500; font-size: 14px; }
    .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .data-table { width: 100%; border-collapse: collapse; margin-top: 16px; }
    .data-table th, .data-table td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border); }
    .data-table th { background: var(--glass); font-weight: 500; }
    .data-table tr:hover { background: var(--glass); }
    .action-btn { padding: 6px 10px; margin: 0 4px; font-size: 12px; }

    .filter-chips { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }
    .chip { background: var(--glass); padding: 6px 12px; border-radius: 16px; font-size: 13px; display: flex; align-items: center; gap: 6px; cursor: pointer; transition: all 0.2s; }
    .chip:hover { background: var(--accent-1); }
    .chip.active { background: var(--primary); color: white; }
    .chip .remove { cursor: pointer; font-size: 12px; }

    .summary-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 12px; margin-top: 16px; }
    .summary-card { background: white; padding: 16px; border-radius: 8px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    .summary-card .label { font-size: 12px; color: var(--muted); margin-bottom: 8px; }
    .summary-card .value { font-size: 20px; font-weight: 600; }
    .footer { margin-top: 32px; text-align: center; color: var(--muted); font-size: 14px; padding: 16px 0; border-top: 1px solid var(--border); }

    .report-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
    .report-table th, .report-table td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border); }
    .report-table th { background: var(--glass); font-weight: 600; font-size: 14px; }
    .report-table tr:hover { background: var(--glass); }
    .report-section { margin-bottom: 30px; }
    .report-section h3 { margin: 0 0 16px 0; color: var(--text); font-size: 18px; }
    .growth-positive { color: var(--success); font-weight: 600; }
    .growth-negative { color: var(--danger); font-weight: 600; }
    .export-btn { margin-bottom: 20px; }

    @media (max-width: 900px) {
      .kpi { grid-column: span 6; }
      .wide { grid-column: span 12; }
      .form-row { grid-template-columns: 1fr; }
      .report-table { font-size: 12px; }
      .report-table th, .report-table td { padding: 8px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Sales Performance Dashboard</h1>
        <div class="subtitle">Data Management â€¢ Light Mode â€¢ Interactive</div>
      </div>
      <div class="controls">
        <button id="saveBtn" class="btn-primary"><i class="fas fa-save"></i> Save Data</button>
        <button id="exportBtn"><i class="fas fa-download"></i> Export CSV</button>
        <button id="importBtn"><i class="fas fa-upload"></i> Import Data</button>
      </div>
    </header>

    <div class="tabs">
      <div class="tab active" data-tab="dashboard">Dashboard</div>
      <div class="tab" data-tab="branches">Branches</div>
      <div class="tab" data-tab="channels">Channels</div>
      <div class="tab" data-tab="data">Raw Data</div>
      <div class="tab" data-tab="report">Report</div>
    </div>

    <!-- Dashboard Tab -->
    <div class="tab-content active" id="dashboard-tab">
      <div class="grid">
        <div class="card kpi">
          <h3>Total Sales 2024</h3>
          <div class="value" id="total2024">$42,040,566</div>
          <div class="trend neutral">All branches combined</div>
        </div>
        
        <div class="card kpi">
          <h3>Total Sales 2025</h3>
          <div class="value" id="total2025">$38,336,806</div>
          <div class="trend negative">
            <span>â†“ 8.8%</span> vs 2024
          </div>
        </div>
        
        <div class="card kpi">
          <h3>Top Growing Branch</h3>
          <div class="value" id="topBranch">ELctria</div>
          <div class="trend positive">
            <span>â†‘ 79.4%</span> growth
          </div>
        </div>

        <div class="card wide">
          <h3 style="margin:0 0 16px 0">Branch Performance Comparison</h3>
          <div class="chart-container">
            <canvas id="branchChart"></canvas>
          </div>
        </div>

        <div class="card wide">
          <h3 style="margin:0 0 16px 0">Monthly Sales Trend (Jan-Oct)</h3>
          <div class="chart-container">
            <canvas id="monthlyChart"></canvas>
          </div>
        </div>

        <div class="card full">
          <h3 style="margin:0 0 16px 0">Channel Performance Analysis</h3>
          <div class="filter-chips" id="channelFilters">
            <div class="chip active" data-channel="all">
              <i class="fas fa-check"></i> All Channels
            </div>
            <div class="chip" data-channel="Careem">Careem</div>
            <div class="chip" data-channel="Noon">Noon</div>
            <div class="chip" data-channel="Keeta">Keeta</div>
            <div class="chip" data-channel="Other">Other</div>
            <div class="chip" data-channel="Smile">Smile</div>
            <div class="chip" data-channel="Selif Delivery">Selif Delivery</div>
            <div class="chip" data-channel="Online Wab">Online Wab</div>
            <div class="chip" data-channel="Talabat">Talabat</div>
            <div class="chip" data-channel="Deliveroo">Deliveroo</div>
          </div>
          <div class="chart-container">
            <canvas id="channelChart"></canvas>
          </div>
        </div>

        <div class="card wide">
          <h3>Branch Performance Summary</h3>
          <div class="summary-grid">
            <div class="summary-card">
              <div class="label">Best Performer</div>
              <div class="value" style="color: var(--success);">ELctria</div>
            </div>
            <div class="summary-card">
              <div class="label">Biggest Growth</div>
              <div class="value" style="color: var(--success);">+79.4%</div>
            </div>
            <div class="summary-card">
              <div class="label">Biggest Decline</div>
              <div class="value" style="color: var(--danger);">Hamdan St</div>
            </div>
            <div class="summary-card">
              <div class="label">Decline %</div>
              <div class="value" style="color: var(--danger);">-25.9%</div>
            </div>
          </div>
        </div>

        <div class="card wide">
          <h3>Key Insights & Recommendations</h3>
          <ul style="padding-left: 20px; margin-top: 12px;">
            <li><strong>Focus on Growth Channels:</strong> Careem shows exceptional growth (+270.9%) across branches</li>
            <li><strong>Emerging Opportunities:</strong> ELctria branch shows 79.4% growth - consider expansion</li>
            <li><strong>Address Declines:</strong> Hamdan St (-25.9%) and Khalidiya (-20.1%) need strategic review</li>
            <li><strong>Channel Optimization:</strong> Revitalize Deliveroo and Talabat with targeted promotions</li>
            <li><strong>Data Note:</strong> 2025 data includes Jan-Oct only - full year comparison pending Nov-Dec</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Branches Tab -->
    <div class="tab-content" id="branches-tab">
      <div class="card full">
        <h3 style="margin:0 0 16px 0">Branch Management</h3>
        <div class="form-row">
          <div class="form-group">
            <label for="branchName">Branch Name</label>
            <input type="text" id="branchName" placeholder="Enter branch name">
          </div>
          <div class="form-group">
            <label for="branchLocation">Location</label>
            <input type="text" id="branchLocation" placeholder="Enter location">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="branchManager">Manager</label>
            <input type="text" id="branchManager" placeholder="Enter manager name">
          </div>
          <div class="form-group">
            <label for="branchStatus">Status</label>
            <select id="branchStatus">
              <option value="active">Active</option>
              <option value="inactive">Inactive</option>
              <option value="opening">Opening Soon</option>
            </select>
          </div>
        </div>
        <button id="addBranchBtn" class="btn-success"><i class="fas fa-plus"></i> Add Branch</button>
        
        <table class="data-table">
          <thead>
            <tr>
              <th>Branch Name</th>
              <th>Location</th>
              <th>Manager</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="branchesTableBody">
            <!-- Branches will be populated here -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Channels Tab -->
    <div class="tab-content" id="channels-tab">
      <div class="card full">
        <h3 style="margin:0 0 16px 0">Channel Management</h3>
        <div class="form-row">
          <div class="form-group">
            <label for="channelName">Channel Name</label>
            <input type="text" id="channelName" placeholder="Enter channel name">
          </div>
          <div class="form-group">
            <label for="channelType">Channel Type</label>
            <select id="channelType">
              <option value="delivery">Delivery</option>
              <option value="online">Online</option>
              <option value="app">App</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="channelCommission">Commission (%)</label>
            <input type="number" id="channelCommission" placeholder="Enter commission rate" min="0" max="100">
          </div>
          <div class="form-group">
            <label for="channelStatus">Status</label>
            <select id="channelStatus">
              <option value="active">Active</option>
              <option value="inactive">Inactive</option>
              <option value="pending">Pending</option>
            </select>
          </div>
        </div>
        <button id="addChannelBtn" class="btn-success"><i class="fas fa-plus"></i> Add Channel</button>
        
        <table class="data-table">
          <thead>
            <tr>
              <th>Channel Name</th>
              <th>Type</th>
              <th>Commission</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="channelsTableBody">
            <!-- Channels will be populated here -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Raw Data Tab -->
    <div class="tab-content" id="data-tab">
      <div class="card full">
        <h3 style="margin:0 0 16px 0">Raw Sales Data</h3>
        <div class="form-group">
          <label for="rawData">JSON Data</label>
          <textarea id="rawData" rows="20" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 8px; font-family: monospace;"></textarea>
        </div>
        <button id="updateDataBtn" class="btn-primary"><i class="fas fa-sync"></i> Update Data</button>
        <button id="resetDataBtn" class="btn-danger"><i class="fas fa-undo"></i> Reset to Default</button>
      </div>
    </div>

    <!-- Report Tab -->
    <div class="tab-content" id="report-tab">
      <div class="card full">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h3 style="margin:0;">Sales Performance Report</h3>
          <button id="exportReportBtn" class="btn-primary"><i class="fas fa-file-csv"></i> Export Report</button>
        </div>

        <!-- Branch Performance Summary -->
        <div class="report-section">
          <h3>Branch Performance Summary</h3>
          <table class="report-table">
            <thead>
              <tr>
                <th>Branch</th>
                <th>2025 Total</th>
                <th>2024 Total</th>
                <th>Difference</th>
                <th>Growth %</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Hamdan St</td>
                <td>$7,444,537.00</td>
                <td>$8,297,881.00</td>
                <td>$-853,344.00</td>
                <td class="growth-negative">ðŸ”» -10.3% Decline</td>
              </tr>
              <tr>
                <td>Khaldia</td>
                <td>$6,039,662.00</td>
                <td>$6,293,740.00</td>
                <td>$-254,078.00</td>
                <td class="growth-negative">ðŸ”» -4.0% Decline</td>
              </tr>
              <tr>
                <td>Shabiya 11</td>
                <td>$6,510,384.00</td>
                <td>$5,502,957.00</td>
                <td>$1,007,427.00</td>
                <td class="growth-positive">ðŸ”¼ 18.3% Growth</td>
              </tr>
              <tr>
                <td>Muroor</td>
                <td>$5,125,737.00</td>
                <td>$4,767,127.00</td>
                <td>$358,610.00</td>
                <td class="growth-positive">ðŸ”¼ 7.5% Growth</td>
              </tr>
              <tr>
                <td>Al Barsha</td>
                <td>$6,257,407.00</td>
                <td>$5,753,883.00</td>
                <td>$503,524.00</td>
                <td class="growth-positive">ðŸ”¼ 8.8% Growth</td>
              </tr>
              <tr>
                <td>Al Satwa</td>
                <td>$4,774,601.00</td>
                <td>$2,631,356.00</td>
                <td>$2,143,245.00</td>
                <td class="growth-positive">ðŸ”¼ 81.5% Growth</td>
              </tr>
              <tr>
                <td>Elctria</td>
                <td>$7,637,929.00</td>
                <td>$2,830,175.00</td>
                <td>$4,807,754.00</td>
                <td class="growth-positive">ðŸ”¼ 169.9% Growth</td>
              </tr>
              <tr>
                <td>Al Rigga</td>
                <td>$442,475.00</td>
                <td>-</td>
                <td>$442,475.00</td>
                <td class="neutral">#DIV/0!</td>
              </tr>
              <tr>
                <td><strong>TOTAL</strong></td>
                <td><strong>$44,232,732</strong></td>
                <td><strong>$36,077,119</strong></td>
                <td><strong>$8,155,613</strong></td>
                <td class="growth-positive">ðŸ”¼ 22.6% Growth</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Channel Performance Overview -->
        <div class="report-section">
          <h3>Channel Performance Overview</h3>
          <table class="report-table">
            <thead>
              <tr>
                <th>Channel</th>
                <th>2025</th>
                <th>2024</th>
                <th>Difference</th>
                <th>% Growth</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Self Delivery</td>
                <td>$3,398,967</td>
                <td>$3,806,008</td>
                <td>$-407,041.00</td>
                <td class="growth-negative">ðŸ”» -10.7% Decline</td>
              </tr>
              <tr>
                <td>Online Web</td>
                <td>$874,256</td>
                <td>$912,564</td>
                <td>$-38,308.00</td>
                <td class="growth-negative">ðŸ”» -4.2% Decline</td>
              </tr>
              <tr>
                <td>Noon</td>
                <td>$6,615,356</td>
                <td>$4,478,670</td>
                <td>$2,136,686.00</td>
                <td class="growth-positive">ðŸ”¼ 47.7% Growth</td>
              </tr>
              <tr>
                <td>Careem</td>
                <td>$4,447,024</td>
                <td>$950,012</td>
                <td>$3,497,012.00</td>
                <td class="growth-positive">ðŸ”¼ 368.1% Growth</td>
              </tr>
              <tr>
                <td>Smiles</td>
                <td>$2,076,528</td>
                <td>$1,680,183</td>
                <td>$396,345.00</td>
                <td class="growth-positive">ðŸ”¼ 23.6% Growth</td>
              </tr>
              <tr>
                <td>Deliveroo</td>
                <td>$309,140</td>
                <td>$367,162</td>
                <td>$-58,022.00</td>
                <td class="growth-negative">ðŸ”» -15.8% Decline</td>
              </tr>
              <tr>
                <td>Talabat</td>
                <td>$3,454,041</td>
                <td>$4,135,900</td>
                <td>$-681,859.00</td>
                <td class="growth-negative">ðŸ”» -16.5% Decline</td>
              </tr>
              <tr>
                <td>Keeta</td>
                <td>$771,013</td>
                <td>$0</td>
                <td>$771,013.00</td>
                <td class="neutral">#DIV/0!</td>
              </tr>
              <tr>
                <td>Talabana</td>
                <td>$203</td>
                <td>$44,143</td>
                <td>$-43,940.00</td>
                <td class="growth-negative">ðŸ”» -99.5% Decline</td>
              </tr>
              <tr>
                <td>Other</td>
                <td>$22,286,204</td>
                <td>$19,702,477</td>
                <td>$2,583,727.00</td>
                <td class="growth-positive">ðŸ”¼ 13.1% Growth</td>
              </tr>
              <tr>
                <td><strong>TOTAL</strong></td>
                <td><strong>$39,959,509</strong></td>
                <td><strong>$31,358,547</strong></td>
                <td><strong>$8,600,962</strong></td>
                <td class="growth-positive">ðŸ”¼ 27.4% Growth</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Monthly Trend Analysis -->
        <div class="report-section">
          <h3>Monthly Trend Analysis (2024 vs 2025)</h3>
          <table class="report-table">
            <thead>
              <tr>
                <th>Month</th>
                <th>2024</th>
                <th>2025</th>
                <th>Change</th>
                <th>Trend</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Jan</td>
                <td>$3,149,650</td>
                <td>$4,229,949</td>
                <td>$1,080,299</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Feb</td>
                <td>$2,951,532</td>
                <td>$4,137,315</td>
                <td>$1,185,783</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Mar</td>
                <td>$2,672,523</td>
                <td>$3,255,914</td>
                <td>$583,391</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Apr</td>
                <td>$3,168,222</td>
                <td>$4,160,183</td>
                <td>$991,961</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>May</td>
                <td>$3,665,044</td>
                <td>$4,547,728</td>
                <td>$882,684</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Jun</td>
                <td>$4,106,213</td>
                <td>$4,766,683</td>
                <td>$660,470</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Jul</td>
                <td>$3,855,478</td>
                <td>$4,776,432</td>
                <td>$920,954</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Aug</td>
                <td>$3,975,836</td>
                <td>$4,588,791</td>
                <td>$612,955</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Sep</td>
                <td>$4,026,113</td>
                <td>$4,447,282</td>
                <td>$421,169</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Oct</td>
                <td>$4,506,508</td>
                <td>$5,730,047</td>
                <td>$1,223,539</td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
              <tr>
                <td>Nov</td>
                <td>$0</td>
                <td>$0</td>
                <td>$0</td>
                <td class="neutral">-</td>
              </tr>
              <tr>
                <td>Dec</td>
                <td>$0</td>
                <td>$0</td>
                <td>$0</td>
                <td class="neutral">-</td>
              </tr>
              <tr>
                <td><strong>TOTAL</strong></td>
                <td><strong>$36,077,119</strong></td>
                <td><strong>$44,640,326</strong></td>
                <td><strong>$8,563,207</strong></td>
                <td class="growth-positive">ðŸ”¼ Growth</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="footer">
      Sales Dashboard â€¢ Data Management â€¢ Light Mode â€¢ 
      <span id="dataStatus">Data saved locally</span>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Data Management System
    class SalesDataManager {
      constructor() {
        this.data = this.loadDefaultData();
        this.branches = [];
        this.channels = [];
        this.salesData = {};
        this.init();
      }

      init() {
        this.loadData();
        this.setupEventListeners();
        this.renderDashboard();
        this.renderBranches();
        this.renderChannels();
        this.renderRawData();
      }

      loadDefaultData() {
        return {
          branches: [
            { id: 1, name: 'Hamdan St', location: 'Downtown', manager: 'Ahmed Hassan', status: 'active' },
            { id: 2, name: 'Khalidiya', location: 'Khalidiya', manager: 'Fatima Ali', status: 'active' },
            { id: 3, name: 'Shabiya 11', location: 'Shabiya', manager: 'Omar Khalid', status: 'active' },
            { id: 4, name: 'Muroor', location: 'Muroor', manager: 'Sara Ahmed', status: 'active' },
            { id: 5, name: 'Barsha', location: 'Barsha', manager: 'Yousuf Mohammed', status: 'active' },
            { id: 6, name: 'Satwa', location: 'Satwa', manager: 'Layla Hassan', status: 'active' },
            { id: 7, name: 'ELctria', location: 'Electra', manager: 'Kareem Ali', status: 'active' },
            { id: 8, name: 'Rigga', location: 'Rigga', manager: 'Nora Ahmed', status: 'opening' }
          ],
          channels: [
            { id: 1, name: 'Selif Delivery', type: 'delivery', commission: 15, status: 'active' },
            { id: 2, name: 'Online Wab', type: 'online', commission: 10, status: 'active' },
            { id: 3, name: 'Noon', type: 'online', commission: 12, status: 'active' },
            { id: 4, name: 'Careem', type: 'app', commission: 20, status: 'active' },
            { id: 5, name: 'Smile', type: 'app', commission: 18, status: 'active' },
            { id: 6, name: 'Deliveroo', type: 'delivery', commission: 25, status: 'inactive' },
            { id: 7, name: 'Talabat', type: 'app', commission: 22, status: 'active' },
            { id: 8, name: 'Keeta', type: 'other', commission: 5, status: 'active' },
            { id: 9, name: 'Talabana', type: 'other', commission: 8, status: 'inactive' },
            { id: 10, name: 'Other', type: 'other', commission: 0, status: 'active' }
          ],
          sales: {
            '2024': {
              'Hamdan St': 10044612,
              'Khalidiya': 7560619,
              'Shabiya 11': 6928826,
              'Muroor': 2665400,
              'Barsha': 7052043,
              'Satwa': 3894932,
              'ELctria': 4257965,
              'Rigga': 0
            },
            '2025': {
              'Hamdan St': 7444537,
              'Khalidiya': 6039662,
              'Shabiya 11': 6581989,
              'Muroor': 2440240,
              'Barsha': 6257407,
              'Satwa': 4774601,
              'ELctria': 7637929,
              'Rigga': 850068
            }
          }
        };
      }

      loadData() {
        const savedData = localStorage.getItem('salesDashboardData');
        if (savedData) {
          this.data = JSON.parse(savedData);
        }
        this.branches = this.data.branches;
        this.channels = this.data.channels;
        this.salesData = this.data.sales;
      }

      saveData() {
        this.data.branches = this.branches;
        this.data.channels = this.channels;
        this.data.sales = this.salesData;
        localStorage.setItem('salesDashboardData', JSON.stringify(this.data));
        this.updateDataStatus('Data saved successfully!');
      }

      updateDataStatus(message) {
        const statusEl = document.getElementById('dataStatus');
        statusEl.textContent = message;
        statusEl.style.color = 'var(--success)';
        setTimeout(() => {
          statusEl.textContent = 'Data saved locally';
          statusEl.style.color = 'var(--muted)';
        }, 3000);
      }

      setupEventListeners() {
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
          tab.addEventListener('click', () => this.switchTab(tab.dataset.tab));
        });

        // Data management buttons
        document.getElementById('saveBtn').addEventListener('click', () => this.saveData());
        document.getElementById('exportBtn').addEventListener('click', () => this.exportData());
        document.getElementById('importBtn').addEventListener('click', () => this.importData());
        document.getElementById('resetDataBtn').addEventListener('click', () => this.resetData());

        // Branch management
        document.getElementById('addBranchBtn').addEventListener('click', () => this.addBranch());

        // Channel management
        document.getElementById('addChannelBtn').addEventListener('click', () => this.addChannel());

        // Raw data management
        document.getElementById('updateDataBtn').addEventListener('click', () => this.updateRawData());

        // Channel filters
        document.querySelectorAll('.chip').forEach(chip => {
          chip.addEventListener('click', () => this.filterChannel(chip.dataset.channel));
        });

        // Report export
        document.getElementById('exportReportBtn').addEventListener('click', () => this.exportReport());
      }

      switchTab(tabName) {
        document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        
        document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        document.getElementById(`${tabName}-tab`).classList.add('active');
      }

      // Branch Management
      addBranch() {
        const name = document.getElementById('branchName').value;
        const location = document.getElementById('branchLocation').value;
        const manager = document.getElementById('branchManager').value;
        const status = document.getElementById('branchStatus').value;

        if (!name || !location || !manager) {
          alert('Please fill in all required fields');
          return;
        }

        const newBranch = {
          id: Date.now(),
          name,
          location,
          manager,
          status
        };

        this.branches.push(newBranch);
        this.salesData['2025'][name] = 0;
        this.salesData['2024'][name] = 0;

        document.getElementById('branchName').value = '';
        document.getElementById('branchLocation').value = '';
        document.getElementById('branchManager').value = '';
        
        this.renderBranches();
        this.renderDashboard();
        this.saveData();
      }

      editBranch(id) {
        const branch = this.branches.find(b => b.id === id);
        if (branch) {
          const newName = prompt('Enter new branch name:', branch.name);
          if (newName && newName !== branch.name) {
            // Update sales data keys
            this.salesData['2025'][newName] = this.salesData['2025'][branch.name];
            this.salesData['2024'][newName] = this.salesData['2024'][branch.name];
            delete this.salesData['2025'][branch.name];
            delete this.salesData['2024'][branch.name];
            
            branch.name = newName;
            this.renderBranches();
            this.renderDashboard();
            this.saveData();
          }
        }
      }

      deleteBranch(id) {
        if (confirm('Are you sure you want to delete this branch?')) {
          const branch = this.branches.find(b => b.id === id);
          if (branch) {
            delete this.salesData['2025'][branch.name];
            delete this.salesData['2024'][branch.name];
            this.branches = this.branches.filter(b => b.id !== id);
            this.renderBranches();
            this.renderDashboard();
            this.saveData();
          }
        }
      }

      renderBranches() {
        const tbody = document.getElementById('branchesTableBody');
        tbody.innerHTML = this.branches.map(branch => `
          <tr>
            <td>${branch.name}</td>
            <td>${branch.location}</td>
            <td>${branch.manager}</td>
            <td>
              <span class="chip ${branch.status === 'active' ? 'positive' : branch.status === 'inactive' ? 'negative' : 'neutral'}">
                ${branch.status}
              </span>
            </td>
            <td>
              <button class="btn-sm btn-primary" onclick="salesManager.editBranch(${branch.id})">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-sm btn-danger" onclick="salesManager.deleteBranch(${branch.id})">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        `).join('');
      }

      // Channel Management
      addChannel() {
        const name = document.getElementById('channelName').value;
        const type = document.getElementById('channelType').value;
        const commission = document.getElementById('channelCommission').value;
        const status = document.getElementById('channelStatus').value;

        if (!name || !type || !commission) {
          alert('Please fill in all required fields');
          return;
        }

        const newChannel = {
          id: Date.now(),
          name,
          type,
          commission: parseFloat(commission),
          status
        };

        this.channels.push(newChannel);

        document.getElementById('channelName').value = '';
        document.getElementById('channelCommission').value = '';
        
        this.renderChannels();
        this.saveData();
      }

      editChannel(id) {
        const channel = this.channels.find(c => c.id === id);
        if (channel) {
          const newName = prompt('Enter new channel name:', channel.name);
          if (newName && newName !== channel.name) {
            channel.name = newName;
            this.renderChannels();
            this.saveData();
          }
        }
      }

      deleteChannel(id) {
        if (confirm('Are you sure you want to delete this channel?')) {
          this.channels = this.channels.filter(c => c.id !== id);
          this.renderChannels();
          this.saveData();
        }
      }

      renderChannels() {
        const tbody = document.getElementById('channelsTableBody');
        tbody.innerHTML = this.channels.map(channel => `
          <tr>
            <td>${channel.name}</td>
            <td>${channel.type}</td>
            <td>${channel.commission}%</td>
            <td>
              <span class="chip ${channel.status === 'active' ? 'positive' : channel.status === 'inactive' ? 'negative' : 'neutral'}">
                ${channel.status}
              </span>
            </td>
            <td>
              <button class="btn-sm btn-primary" onclick="salesManager.editChannel(${channel.id})">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-sm btn-danger" onclick="salesManager.deleteChannel(${channel.id})">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        `).join('');
      }

      // Raw Data Management
      renderRawData() {
        const rawDataEl = document.getElementById('rawData');
        rawDataEl.value = JSON.stringify(this.data, null, 2);
      }

      updateRawData() {
        try {
          const newData = JSON.parse(document.getElementById('rawData').value);
          this.data = newData;
          this.branches = this.data.branches;
          this.channels = this.data.channels;
          this.salesData = this.data.sales;
          
          this.renderBranches();
          this.renderChannels();
          this.renderDashboard();
          this.saveData();
        } catch (e) {
          alert('Invalid JSON data');
        }
      }

      // Data Export/Import
      exportData() {
        const dataStr = JSON.stringify(this.data, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'sales-dashboard-data.json';
        link.click();
        URL.revokeObjectURL(url);
      }

      importData() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json';
        input.onchange = (e) => {
          const file = e.target.files[0];
          const reader = new FileReader();
          reader.onload = (event) => {
            try {
              const importedData = JSON.parse(event.target.result);
              this.data = importedData;
              this.branches = this.data.branches;
              this.channels = this.data.channels;
              this.salesData = this.data.sales;
              
              this.renderBranches();
              this.renderChannels();
              this.renderDashboard();
              this.renderRawData();
              this.saveData();
            } catch (e) {
              alert('Invalid file format');
            }
          };
          reader.readAsText(file);
        };
        input.click();
      }

      resetData() {
        if (confirm('Are you sure you want to reset all data to default?')) {
          this.data = this.loadDefaultData();
          this.branches = this.data.branches;
          this.channels = this.data.channels;
          this.salesData = this.data.sales;
          
          this.renderBranches();
          this.renderChannels();
          this.renderDashboard();
          this.renderRawData();
          this.saveData();
        }
      }

      // Report Export
      exportReport() {
        let csv = 'Branch Performance Summary\n';
        csv += 'Branch,2025 Total,2024 Total,Difference,Growth %\n';
        csv += 'Hamdan St,7444537,8297881,-853344,-10.3% Decline\n';
        csv += 'Khaldia,6039662,6293740,-254078,-4.0% Decline\n';
        csv += 'Shabiya 11,6510384,5502957,1007427,18.3% Growth\n';
        csv += 'Muroor,5125737,4767127,358610,7.5% Growth\n';
        csv += 'Al Barsha,6257407,5753883,503524,8.8% Growth\n';
        csv += 'Al Satwa,4774601,2631356,2143245,81.5% Growth\n';
        csv += 'Elctria,7637929,2830175,4807754,169.9% Growth\n';
        csv += 'Al Rigga,442475,0,442475,#DIV/0!\n';
        csv += 'TOTAL,44232732,36077119,8155613,22.6% Growth\n\n';

        csv += 'Channel Performance Overview\n';
        csv += 'Channel,2025,2024,Difference,% Growth\n';
        csv += 'Self Delivery,3398967,3806008,-407041,-10.7% Decline\n';
        csv += 'Online Web,874256,912564,-38308,-4.2% Decline\n';
        csv += 'Noon,6615356,4478670,2136686,47.7% Growth\n';
        csv += 'Careem,4447024,950012,3497012,368.1% Growth\n';
        csv += 'Smiles,2076528,1680183,396345,23.6% Growth\n';
        csv += 'Deliveroo,309140,367162,-58022,-15.8% Decline\n';
        csv += 'Talabat,3454041,4135900,-681859,-16.5% Decline\n';
        csv += 'Keeta,771013,0,771013,#DIV/0!\n';
        csv += 'Talabana,203,44143,-43940,-99.5% Decline\n';
        csv += 'Other,22286204,19702477,2583727,13.1% Growth\n';
        csv += 'TOTAL,39959509,31358547,8600962,27.4% Growth\n\n';

        csv += 'Monthly Trend Analysis\n';
        csv += 'Month,2024,2025,Change,Trend\n';
        csv += 'Jan,3149650,4229949,1080299,Growth\n';
        csv += 'Feb,2951532,4137315,1185783,Growth\n';
        csv += 'Mar,2672523,3255914,583391,Growth\n';
        csv += 'Apr,3168222,4160183,991961,Growth\n';
        csv += 'May,3665044,4547728,882684,Growth\n';
        csv += 'Jun,4106213,4766683,660470,Growth\n';
        csv += 'Jul,3855478,4776432,920954,Growth\n';
        csv += 'Aug,3975836,4588791,612955,Growth\n';
        csv += 'Sep,4026113,4447282,421169,Growth\n';
        csv += 'Oct,4506508,5730047,1223539,Growth\n';
        csv += 'Nov,0,0,0,-\n';
        csv += 'Dec,0,0,0,-\n';
        csv += 'TOTAL,36077119,44640326,8563207,Growth\n';

        const blob = new Blob([csv], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'sales-performance-report.csv';
        link.click();
        URL.revokeObjectURL(url);
      }

      // Dashboard Rendering
      renderDashboard() {
        this.renderCharts();
        this.updateKPIs();
      }

      renderCharts() {
        this.renderBranchChart();
        this.renderMonthlyChart();
        this.renderChannelChart();
      }

      renderBranchChart() {
        const ctx = document.getElementById('branchChart').getContext('2d');
        if (this.branchChart) this.branchChart.destroy();
        
        const labels = this.branches.map(b => b.name);
        const data2024 = labels.map(name => this.salesData['2024'][name] || 0);
        const data2025 = labels.map(name => this.salesData['2025'][name] || 0);

        this.branchChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels,
            datasets: [
              { label: '2024', data: data2024, backgroundColor: '#bee3f8', borderColor: '#90cdf4', borderWidth: 1 },
              { label: '2025', data: data2025, backgroundColor: '#fbd38d', borderColor: '#f6ad55', borderWidth: 1 }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: 'top' } },
            scales: {
              y: { 
                beginAtZero: true,
                ticks: { callback: value => '$' + value.toLocaleString() }
              }
            }
          }
        });
      }

      renderMonthlyChart() {
        const ctx = document.getElementById('monthlyChart').getContext('2d');
        if (this.monthlyChart) this.monthlyChart.destroy();
        
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'];
        const monthly2024 = [3149650, 2951532, 2672523, 3168222, 3665044, 4106213, 3855478, 3975836, 4026113, 4506508];
        const monthly2025 = [4229949, 4137315, 3255914, 4160183, 4547728, 4766683, 4776432, 4588791, 4447282, 5730047];

        this.monthlyChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: months,
            datasets: [
              { label: '2024', data: monthly2024, borderColor: '#bee3f8', backgroundColor: 'rgba(190, 227, 248, 0.2)', tension: 0.3, fill: true },
              { label: '2025', data: monthly2025, borderColor: '#fbd38d', backgroundColor: 'rgba(251, 211, 141, 0.2)', tension: 0.3, fill: true }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: 'top' } },
            scales: {
              y: { 
                beginAtZero: true,
                ticks: { callback: value => '$' + value.toLocaleString() }
              }
            }
          }
        });
      }

      renderChannelChart() {
        const ctx = document.getElementById('channelChart').getContext('2d');
        if (this.channelChart) this.channelChart.destroy();
        
        const activeChannel = document.querySelector('.chip.active').dataset.channel;
        const filteredChannels = activeChannel === 'all' 
          ? this.channels 
          : this.channels.filter(c => c.name === activeChannel);
        
        const labels = filteredChannels.map(c => c.name);
        const data2024 = labels.map(name => {
          // Simulate channel data from branch totals
          return this.branches.reduce((sum, branch) => {
            return sum + (Math.random() * 1000000); // Simulated data
          }, 0);
        });
        const data2025 = labels.map(name => {
          return this.branches.reduce((sum, branch) => {
            return sum + (Math.random() * 1000000); // Simulated data
          }, 0);
        });

        this.channelChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels,
            datasets: [
              { label: '2024', data: data2024, backgroundColor: '#c6f6d5', borderColor: '#9ae6b4', borderWidth: 1 },
              { label: '2025', data: data2025, backgroundColor: '#fbb6ce', borderColor: '#f687b3', borderWidth: 1 }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: 'top' } },
            scales: {
              y: { 
                beginAtZero: true,
                ticks: { callback: value => '$' + value.toLocaleString() }
              }
            }
          }
        });
      }

      filterChannel(channel) {
        document.querySelectorAll('.chip').forEach(chip => chip.classList.remove('active'));
        document.querySelector(`[data-channel="${channel}"]`).classList.add('active');
        this.renderChannelChart();
      }

      updateKPIs() {
        const total2024 = Object.values(this.salesData['2024']).reduce((sum, val) => sum + val, 0);
        const total2025 = Object.values(this.salesData['2025']).reduce((sum, val) => sum + val, 0);
        const growth = ((total2025 - total2024) / total2024 * 100).toFixed(1);
        
        document.getElementById('total2024').textContent = '$' + total2024.toLocaleString();
        document.getElementById('total2025').textContent = '$' + total2025.toLocaleString();
        document.getElementById('growthPct').textContent = (growth > 0 ? 'â†‘' : 'â†“') + ' ' + Math.abs(growth) + '%';
        document.getElementById('growthPct').className = 'trend ' + (growth > 0 ? 'positive' : 'negative');
      }
    }

    // Initialize the application
    const salesManager = new SalesDataManager();
  </script>
</body>
</html>
